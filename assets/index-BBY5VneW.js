var G=Object.defineProperty;var j=(i,e,t)=>e in i?G(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var s=(i,e,t)=>(j(i,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))h(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&h(d)}).observe(document,{childList:!0,subtree:!0});function t(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function h(r){if(r.ep)return;r.ep=!0;const n=t(r);fetch(r.href,n)}})();class U{constructor(e){s(this,"x");s(this,"y");s(this,"width");s(this,"height");s(this,"speed");s(this,"direction");s(this,"health");this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this.speed=e.speed,this.direction="right",this.health=10}move(e,t){"ArrowLeft"in e&&(this.x/this.speed>=1?this.x-=this.speed:this.x=0,this.direction="left"),"ArrowRight"in e&&(this.x+this.width<=t.width-this.speed?this.x+=this.speed:this.x=t.width-this.width,this.direction="right"),"ArrowUp"in e&&(this.y/this.speed>=1?this.y-=this.speed:this.y=0,this.direction="up"),"ArrowDown"in e&&(this.y+this.height<=t.height-this.speed?this.y+=this.speed:this.y=t.height-this.height,this.direction="down")}checkLaserCollision(e,t){return e.some(r=>t.checkCollision(this,"isPlayer",r,!0))&&(console.log("collide"),e=e.filter(r=>!t.checkCollision(this,"isPlayer",r,!1)),this.health-=1),e}}class R{constructor(e,t,h,r,n){s(this,"x");s(this,"y");s(this,"radius");s(this,"dx");s(this,"dy");s(this,"alpha");this.x=e,this.y=t,this.radius=h,this.dx=r,this.dy=n,this.alpha=1}draw(e){e.save(),e.globalAlpha=this.alpha,e.fillStyle="lightgray",e.beginPath(),e.arc(this.x,this.y,this.radius,0,Math.PI*2,!1),e.fill(),e.restore()}update(e){this.draw(e),this.alpha-=.01,this.x+=this.dx,this.y+=this.dy}}class S{constructor(e,t,h){s(this,"alpha");s(this,"alphaMax");s(this,"fadeIn");s(this,"fadeOut");s(this,"score");s(this,"x");s(this,"y");this.alpha=.06,this.alphaMax=1,this.fadeIn=!0,this.fadeOut=!1,this.score=h,this.x=e,this.y=t}checkFading(){this.alpha===this.alphaMax&&!this.fadeOut&&(this.fadeIn=!0,this.fadeOut=!0)}draw(e){e.save(),this.updateAlpha(),e.globalAlpha=this.alpha,e.fillStyle="lightgray",e==null||e.fillText(`${this.score}`,this.x,this.y),e.fill(),e.restore()}updateAlpha(){this.fadeIn&&this.alpha<this.alphaMax?this.alpha+=.02:this.alpha>=this.alphaMax?(this.fadeIn=!1,this.fadeOut=!0,this.alpha-=.02):this.fadeIn==!1&&this.alpha<this.alphaMax&&(this.alpha-=.02)}}class ${constructor(e,t){s(this,"x");s(this,"y");s(this,"radius");s(this,"alpha");this.radius=100,this.x=e,this.y=t,this.alpha=1}draw(e){e.save(),e.fillStyle="red",e.globalAlpha=this.alpha,e.beginPath(),e.arc(this.x,this.y,this.radius,0,Math.PI*2,!1),e.fill(),e.restore()}update(e){this.draw(e),this.radius<300&&(this.radius+=10),this.alpha-=.02}}class A{constructor(e){s(this,"boundaryUp");s(this,"boundaryDown");s(this,"boundaryLeft");s(this,"boundaryRight");s(this,"enemyDirection");s(this,"explosions");s(this,"scores");s(this,"bombs");s(this,"bombExplosions");s(this,"score");s(this,"powerUpOn");s(this,"powerUpTimer");s(this,"laserFrequency");this.boundaryUp=0,this.boundaryDown=e.height,this.boundaryLeft=0,this.boundaryRight=e.width,this.enemyDirection="right",this.explosions=[],this.scores=[],this.bombs=[],this.bombExplosions=[],this.score=0,this.powerUpOn=!1,this.powerUpTimer=0,this.laserFrequency=10}checkCollision(e,t,h,r){const n=e.x,d=e.x+e.width,p=e.y+e.height,E=e.y,y=h.x,M=h.x+h.width,Y=h.y+h.height,P=h.y;return t==="isEnemy"&&P<=p&&(y<=d&&y>=n||M>=n&&M<=d)?(console.log("Hitmarker"),r&&(this.explosions.push(this.createExplosion(e)),this.scores.push(new S(e.x,e.y,100))),!0):t==="isPlayer"&&Y>=E&&P<=p&&(y<=d&&y>=n||M>=n&&M<=d)?(console.log("Player hit"),!0):!1}checkCollisionBomb(e,t){var h=e.x,r=e.y;e.x<t.x?h=t.x:e.x>=t.x+t.width&&(h=t.x+t.width),e.y<t.y?r=t.y:e.y>t.y+t.height&&(r=t.y+t.height);const n=e.x-h,d=e.y-r;return Math.sqrt(n*n+d*d)<=e.radius?(console.log("Kaboom"),this.bombExplosions.push(new $(e.x,e.y)),!0):!1}checkCollisionPowerUp(e,t){var h=e.x,r=e.y;e.x<t.x?h=t.x:e.x>=t.x+t.width&&(h=t.x+t.width),e.y<t.y?r=t.y:e.y>t.y+t.height&&(r=t.y+t.height);const n=e.x-h,d=e.y-r;return Math.sqrt(n*n+d*d)<=e.radius?(console.log("Power On"),this.powerUpOn=!0,this.laserFrequency=2,!0):!1}checkPowerUp(){this.powerUpTimer>1e3&&(this.powerUpOn=!1,this.laserFrequency=10,this.powerUpTimer=0),this.powerUpTimer+=1}checkCollisionExplosion(e,t){var h=t.x,r=t.y;t.x<e.x?h=e.x:t.x>=e.x+e.width&&(h=e.x+e.width),t.y<e.y?r=e.y:t.y>e.y+e.height&&(r=e.y+e.height);const n=t.x-h,d=t.y-r;return Math.sqrt(n*n+d*d)<=t.radius?(this.scores.push(new S(e.x,e.y,50)),console.log("Enemy destroyed with bomb"),this.score+=50,!0):!1}createExplosion(e){let t=[];for(let h=0;h<=150;h++){let r=(Math.random()-.5)*(Math.random()*6),n=(Math.random()-.5)*(Math.random()*6),d=Math.random()*3;const p=e.x+e.width/2,E=e.y+e.height/2;let y=new R(p,E,d,r,n);t.push(y)}return t}}class q{constructor(e){s(this,"x");s(this,"y");s(this,"width");s(this,"height");s(this,"shooter");s(this,"imgUrl");s(this,"collided");s(this,"image");this.x=e.x,this.y=e.y,this.width=10,this.height=10,this.shooter=e.shooter,this.imgUrl=this.imageUrl(this.shooter),this.collided=!1;const t=new Image;t.src=this.imgUrl,this.image=t}imageUrl(e){return e==="enemy"?"RedLaser.jpg":"GreenLaser.jpg"}}class N{constructor(e){s(this,"x");s(this,"y");s(this,"width");s(this,"height");s(this,"speed");s(this,"direction");s(this,"shootChance");s(this,"image");this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this.speed=e.speed,this.direction="right",this.shootChance=e.shootChance;const t=new Image;t.src="Invader.png",this.image=t}checkLaserCollision(e,t){return e.some(r=>t.checkCollision(this,"isEnemy",r,!0))?(console.log("collide"),e=e.filter(r=>!t.checkCollision(this,"isEnemy",r,!1)),{collision:!0,lasers:e}):{collision:!1,lasers:e}}shootLaser(){return Math.floor(Math.random()*(this.shootChance+2))>=this.shootChance}}class C{constructor(){s(this,"direction");s(this,"enemiesMatrix");s(this,"shootChance");this.direction="right",this.shootChance=200,this.enemiesMatrix=this.createEnemies()}setShootChance(){this.shootChance>500&&(this.shootChance-=100)}createEnemies(){let e=[];var t=100,h=0;for(let r=0;r<5;r++){e.push([]);for(let n=0;n<10;n++)e[r].push(new N({x:t,y:h,width:30,height:30,speed:5,shootChance:this.shootChance})),t+=100;h+=50,t=100}return e}edgeEnemyHorde(){var e=this.enemiesMatrix.map(r=>r[this.direction==="right"?r.length-1:0]);function t(r,n,d){return!r&&!n?n:r?n?d==="right"?n.x<r.x?r:n:n.x>r.x?r:n:r:n}var h=e.reduce((r,n)=>t(r,n,this.direction));return h}checkHordeLaserCollision(e,t){for(let r=0;r<this.enemiesMatrix.length;r++)for(let n=0;n<this.enemiesMatrix[r].length;n++){var h=this.enemiesMatrix[r][n];if(h){const d=h.checkLaserCollision(e,t),p=d.collision;e=d.lasers,p&&(this.enemiesMatrix[r][n]=null,t.score+=100)}}return e}shootLasers(e){for(let t of this.enemiesMatrix)for(let h=0;h<t.length;h++)if(t[h]!==null&&t[h].shootLaser()){const r=t[h].x+t[h].width/2;e.push(new q({x:r,y:t[h].y,speed:10,shooter:"enemy"}))}return e}moveHordeRight(){this.enemiesMatrix.map(e=>e.map(t=>t?t.x+=1:null))}moveHordeLeft(){this.enemiesMatrix.map(e=>e.map(t=>t?t.x-=1:null))}moveHordeDown(){this.enemiesMatrix.map(e=>e.map(t=>t?t.y+=5:null))}checkHordeRightExists(){return this.enemiesMatrix.every(e=>e[e.length-1]===null)}checkHordeLeftExists(){return this.enemiesMatrix.every(e=>e[0]===null)}}class K{constructor(e,t,h){s(this,"xPos");s(this,"yPos");s(this,"radius");this.xPos=e,this.yPos=t,this.radius=h}}class W{constructor(e,t){s(this,"x");s(this,"y");s(this,"dx");s(this,"dy");s(this,"radius");s(this,"fadeIn");s(this,"fadeOut");s(this,"alpha");this.x=e,this.y=t,this.dx=this.determineDir(),this.dy=this.determineDir(),this.radius=50,this.alpha=1,this.fadeIn=!0,this.fadeOut=!1}draw(e){e.fillStyle="red",e.save(),this.updateAlpha(),e.globalAlpha=this.alpha,e.beginPath(),e.arc(this.x,this.y,this.radius,0,Math.PI*2,!1),e.fill(),e.restore()}update(e){this.x-this.radius<=0||this.x+this.radius>=e.width?this.dx*=-1:(this.y-this.radius<=0||this.y+this.radius>=e.height)&&(this.dy*=-1),this.x+=this.dx,this.y+=this.dy}determineDir(){return Math.random()<.5?-2:2}updateAlpha(){this.fadeIn&&this.alpha<1?this.alpha+=.01:this.alpha>=1?(this.fadeIn=!1,this.fadeOut=!0,this.alpha-=.01):this.fadeOut&&this.alpha>.5?this.alpha-=.01:this.fadeOut&&this.alpha<=.5&&(this.fadeIn=!0,this.fadeOut=!1,this.alpha+=.01)}}class z{constructor(e){s(this,"x");s(this,"y");s(this,"radius");s(this,"lightness");s(this,"lighter");s(this,"darker");this.y=e,this.radius=30,this.x=this.radius-30,this.lighter=!1,this.darker=!0,this.lightness=50}draw(e){this.updateLightness(),e.fillStyle=`hsl(62,100%,${this.lightness}%)`,e.beginPath(),e.arc(this.x,this.y,this.radius,0,Math.PI*2,!1),e.fill()}update(e){this.draw(e),this.x+=4}updateLightness(){this.lighter&&this.lightness<100?this.lightness+=1:this.lightness>=100?(this.lighter=!1,this.darker=!0,this.lightness-=1):this.darker&&this.lightness>50?this.lightness-=1:this.darker&&this.lightness<=50&&(this.lighter=!0,this.darker=!1,this.lightness+=1)}}let l=document.querySelector("canvas");const o=l==null?void 0:l.getContext("2d");l.width=window.innerWidth;l.height=window.innerHeight;let D=document.getElementById("GameOverModelEl"),J=document.getElementById("GameOverScoreEL"),Q=document.getElementById("RestartButtonEL"),H=document.getElementById("StartModelEl");var L={};window.addEventListener("keydown",function(i){L[i.key]=!0,i.preventDefault()});window.addEventListener("keyup",function(i){delete L[i.key]});let w=[new C],f=[],u=[],x=[],c,a=new A(l),m=new U({x:l.width/2,y:l.height-200,width:50,height:50,speed:5}),k=1,b=0,F=1e3,v=0,g=0;for(let i=0;i<l.height;i++)x=I(x,i);function Z(){w=[new C],f=[],u=[],x=[],a=new A(l),m=new U({x:l.width/2,y:l.height-200,width:50,height:50,speed:5}),k=1,b=0,F=1e3,v=0,g=0}function _(i){const e=new Image;e.src="spaceship.png",o==null||o.drawImage(e,i.x,i.y,i.width,i.height)}function V(i){o.fillStyle="#F050F0",i.map(e=>e.enemiesMatrix.map(t=>t.map(h=>h&&(o==null?void 0:o.drawImage(h.image,h.x,h.y,h.width,h.height)))))}function I(i,e){var t=Math.floor(Math.random()*(l.width+2)),h=new K(t,e,Math.random()*2);return i.push(h),i}function T(i){o.fillStyle="white",i=I(i,l.height);for(let e of i)o==null||o.beginPath(),o==null||o.arc(e.xPos,e.yPos,e.radius,0,2*Math.PI),o==null||o.fill(),e.yPos-=1}function B(i){o.fillStyle="#c30010";const e=new Image;e.src="RedLaser.jpg",i&&i.map(t=>o==null?void 0:o.drawImage(t.image,t.x,t.y,t.width,t.height*2))}function ee(){var i=a.explosions;for(let e of i)e.forEach((t,h)=>{t.alpha<=0?e.splice(h,1):t.update(o)})}function te(){for(let i of a.scores)i.draw(o);a.scores.length!==0&&(a.scores=a.scores.filter(i=>i.alpha>=.06))}function ie(){var i=Math.floor(Math.random()*(l.width+2-100)),e=Math.floor(Math.random()*(l.height+2));a.bombs.push(new W(i,e))}function se(){a.bombs.forEach((e,t)=>{e.update(l),f.forEach((h,r)=>{a.checkCollisionBomb(e,h)&&(a.bombs.splice(t,1),f.splice(r,1))}),e.draw(o)})}function he(){a.bombExplosions.forEach(i=>{i.update(o)});for(let i of w)for(let e of a.bombExplosions)i.enemiesMatrix=i.enemiesMatrix.map(t=>t.filter(h=>h&&!a.checkCollisionExplosion(h,e)));a.bombExplosions=a.bombExplosions.filter(i=>i.radius<300)}function re(){m.move(L,l)}function oe(i){return!(i.y<=0)}function ne(i,e){return" "in L&&i>a.laserFrequency?(f.push(new q({x:e.x+e.width/2,y:e.y,speed:10,shooter:"player"})),0):(f&&f.map(t=>t.y-=10),u&&u.map(t=>t.y+=10),f=f.filter(t=>oe(t)),i+1)}function ae(){for(let t of w){if(t.direction==="right"){if(t.checkHordeRightExists()){t.enemiesMatrix=t.enemiesMatrix.map(h=>h.slice(0,-1));continue}var i=t.edgeEnemyHorde();i&&i.x+i.width>a.boundaryRight-i.speed?(t.moveHordeDown(),t.direction="left"):t.moveHordeRight()}else if(t.direction==="left"){if(t.checkHordeLeftExists()){t.enemiesMatrix=t.enemiesMatrix.map(h=>h.slice(1));continue}var e=t.edgeEnemyHorde();e&&e.x<a.boundaryLeft+e.speed?(t.moveHordeDown(),t.direction="right"):t.moveHordeLeft()}u=t.shootLasers(u)}}function le(i){if(i.length!==0){for(let e of w)if(i=e.checkHordeLaserCollision(i,a),i.length===0)return i}return i}function de(){c==null||c.update(o);for(let i of f)c&&a.checkCollisionPowerUp(c,i)&&(c=null,g=0)}function fe(){o==null||o.clearRect(0,0,l.width,l.height),o.fillStyle="black",o==null||o.fillRect(0,0,l.width,l.height),x&&T(x),_(m),w&&V(w),f&&B(f),u&&B(u),a.explosions&&ee(),a.scores&&te(),a.bombs&&se(),a.bombExplosions&&he(),c&&de(),o&&(o.font="48px serif"),o.fillStyle="#00ff00",o==null||o.fillText(`${m.health}`,100,50,100),o==null||o.fillText(`${a.score}`,100,l.height-50,100)}function O(){if(re(),k=ne(k,m),ae(),u.length!==0&&(u=m.checkLaserCollision(u,a)),f=le(f),b+=1,b===F&&(w.push(new C),b=0),v>=100&&a.bombs.length<2&&(ie(),v=0),g>=100&&!c&&!a.powerUpOn){Math.floor(Math.random()*(l.width+2-30));var i=Math.floor(Math.random()*(l.height/2+2));c=new z(i-30)}a.powerUpOn&&a.checkPowerUp(),c&&c.x-30>=l.width&&(c=null,g=0),v+=1,g+=1,fe(),m.health!==0?window.requestAnimationFrame(O):(D.style.display="block",J.innerHTML=`${a.score}`)}function X(){o==null||o.clearRect(0,0,l.width,l.height),o.fillStyle="black",o==null||o.fillRect(0,0,l.width,l.height),x&&T(x),window.requestAnimationFrame(X)}const ce=window.requestAnimationFrame(X);Q.addEventListener("click",()=>{Z(),O();for(let i=0;i<l.height;i++)x=I(x,i);D.style.display="none",cancelAnimationFrame(ce)});H.addEventListener("click",()=>{O(),H.style.display="none"});
